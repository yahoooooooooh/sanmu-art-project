/* 全局样式 */
html { height: 100%; overflow: hidden; }
body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; margin: 0; padding: 0; background-color: #f4f4f4; color: #333; display: flex; flex-direction: column; height: 100%; overflow: hidden; }

/* 头部样式 */
header { background: #333; color: #fff; padding: 15px 0; text-align: center; border-bottom: #77aaff 3px solid; flex-shrink: 0; }
header h1 { margin: 0; font-size: 26px; }

/* 主容器布局 */
.main-container { display: flex; flex: 1; overflow: hidden; }

/* 左侧边栏样式 */
.sidebar { width: 200px; background: #e9ecef; padding: 15px; border-right: 1px solid #ddd; overflow-y: auto; flex-shrink: 0; display: flex; flex-direction: column; }
.sidebar h2 { margin-top: 0; font-size: 1.4em; color: #333; border-bottom: 1px solid #ccc; padding-bottom: 8px; margin-bottom: 12px; }
.sidebar nav ul { list-style: none; padding: 0; margin: 0; }
.sidebar nav ul li a { display: block; padding: 8px 12px; text-decoration: none; color: #337ab7; border-radius: 4px; margin-bottom: 5px; transition: background-color 0.2s ease, color 0.2s ease; font-size: 0.95em; }
.sidebar nav ul li a:hover, .sidebar nav ul li a.active { background-color: #337ab7; color: #fff; }

/* 右侧内容区样式 */
.content-area { flex: 1; overflow: hidden; background: #fff; display: flex; }
.view-section { width: 100%; flex-grow: 1; overflow: hidden; display: none; padding: 20px; box-sizing: border-box; }

/* 文章视图特定样式 */
#articles-view { flex-direction: row; gap: 20px; }
#articles-list-container { width: 30%; min-width: 180px; border-right: 1px solid #eee; padding-right: 15px; display: flex; flex-direction: column; overflow: hidden; }
#articles-list-container h2 { margin-top: 0; font-size: 1.3em; flex-shrink: 0; }
#articles-list-ul { list-style: none; padding: 0; margin: 0; overflow-y: auto; flex-grow: 1; }
#articles-list-ul li { padding: 7px 0; border-bottom: 1px dotted #ddd; }
#articles-list-ul li:last-child { border-bottom: none; }
#articles-list-ul li a { text-decoration: none; color: #337ab7; }
#articles-list-ul li a:hover { color: #23527c; }
#article-content-container { flex: 1; overflow-y: auto; padding-left: 15px; }

/* 图片画廊视图特定样式 (修复叠加和压扁问题) */
#gallery-view { display: flex; flex-direction: column; overflow: hidden; }
#gallery-view h2 { margin-top: 0; font-size: 1.3em; flex-shrink: 0; padding-bottom: 10px; border-bottom: 1px solid #eee; margin-bottom: 10px; }
.gallery-container {
    display: grid; 
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); 
    gap: 15px; /* 网格项之间的间距 */
    overflow-y: auto; 
    flex-grow: 1; 
    padding: 10px; /* 容器内边距，确保item和边缘有空隙 */
}
.gallery-item {
    border: 1px solid #ddd;
    border-radius: 4px;
    background-color: #f9f9f9;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    display: flex; /* 使用 flex 布局来控制内部图片和标题 */
    flex-direction: column;
    overflow: hidden; /* 确保内容不会溢出 item 边界导致重叠 */
    aspect-ratio: 1 / 1; /* **** 尝试方形缩略图 **** 你可以改成 4 / 3 或 3 / 4 试试 */
}
.gallery-item img {
    display: block; /* 消除图片底部可能的空隙 */
    width: 100%;    /* 图片宽度填满其容器 */
    height: 100%;   /* 图片高度也尝试填满其容器 */
    object-fit: cover; /* 保持比例，裁剪以填满，这是关键 */
    border-radius: 3px 3px 0 0; /* 图片顶部圆角，如果标题在下方 */
    flex-grow: 1; /* 让图片尝试占据更多空间，如果标题高度固定的话 */
    /* 如果希望图片和标题之间有明确的分割，并且图片不总是填满 item 的所有可用高度，
       可以给图片一个 flex-shrink:0; 并设置一个 max-height，或者调整标题的 flex 属性。
       目前用 aspect-ratio 和 object-fit:cover 应该能得到比较好的填充效果。
    */
}
.gallery-item-title {
    font-size: 0.8em; /* 略微减小标题字号 */
    color: #333;   /* 标题颜色改深一点 */
    padding: 6px 8px; /* 标题内边距 */
    text-align: center;
    flex-shrink: 0; /* 防止标题被压缩 */
    line-height: 1.2;
    max-height: 2.4em; /* 限制标题最多显示2行 (1.2em * 2) */
    overflow: hidden;
    text-overflow: ellipsis; /* 文字溢出时显示省略号 */
    white-space: normal; /* 确保能换行 */
    /* background-color: rgba(255,255,255,0.8); /* 可以给标题一个半透明背景增加可读性 */
}


/* Markdown 样式 (保持不变) */
#article-content-container h1 { font-size: 1.8em; } 
#article-content-container h2 { font-size: 1.6em; }
#article-content-container h3 { font-size: 1.4em; }
#article-content-container h4 { font-size: 1.2em; }
#article-content-container p { margin-bottom: 1em; }
#article-content-container ul, #article-content-container ol { margin-left: 20px; margin-bottom: 1em; }
#article-content-container blockquote { padding: 10px 20px; margin: 0 0 20px; border-left: 5px solid #eee; background-color: #f9f9f9; }
#article-content-container pre { background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: "Courier New", Courier, monospace; }
#article-content-container code { background: #f4f4f4; padding: 0.2em 0.4em; margin: 0; font-size: 85%; border-radius: 3px; font-family: "Courier New", Courier, monospace; }
#article-content-container pre code { padding: 0; background: none; border-radius: 0; }
#article-content-container img { max-width: 100%; height: auto; border-radius: 5px; margin: 10px 0; }

/* Giscus 样式 (保持不变) */
#giscus-placeholder-container, 
[id^="giscus-comments-for-"] { 
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #eee;
}

/* 页脚样式 (保持不变) */
footer { background: #333; color: #fff; text-align: center; padding: 15px 0; flex-shrink: 0; }

/* 响应式调整 (保持不变) */
@media (max-width: 768px) {
    html, body { overflow-y: auto; } 
    .main-container { flex-direction: column; overflow: visible; }
    .sidebar { width: 100%; max-height: none; border-bottom: 1px solid #ddd; }
    .sidebar nav ul { display: flex; justify-content: space-around; }
    .content-area { padding: 0; overflow-y: visible; } 
    .view-section { height: auto; overflow: visible; padding:15px; } 
    #articles-view { flex-direction: column; height: auto; }
    #articles-list-container,
    #article-content-container { width: 100%; border-right: none; padding-right: 0; height: auto; max-height: none; overflow: visible; }
    #articles-list-container { margin-bottom: 20px; }
    #article-content-container { padding-left: 0; }
    .gallery-container { grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; overflow-y: visible;} 
    .gallery-item { aspect-ratio: 1 / 1; }
}
@media (max-width: 480px) {
    .gallery-container { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
    .sidebar nav ul li a { padding: 8px 5px; font-size: 0.9em; }
    header h1 { font-size: 20px; }
}